{% extends "base.html" %}
{% block content %}
<div class="container">
  <h3>{{ post.user.username }}'s Post</h3>
  <p>{{ post.body }}</p>

  {% if post.media %}
    <img src="{{ post.media.url }}" class="img-fluid rounded mb-3">
  {% endif %}

  <small class="text-muted">{{ post.created_at }}</small>

  <!-- Faqat egasiga ko‘rinadi -->
  {% if request.user == post.user %}
    <div class="mt-3 d-flex gap-2">
      <!-- Edit tugmasi -->
      <a href="{% url 'post_update' post.id %}"
         class="btn btn-primary w-100 d-flex align-items-center justify-content-center">
        ✏️ Edit
      </a>

      <!-- Delete tugmasi -->
      <a href="{% url 'post_delete' post.id %}"
         class="btn btn-danger w-100 d-flex align-items-center justify-content-center">
        🗑️ Delete
      </a>
    </div>
  {% endif %}

  <hr>

  <!-- Comments -->
  <h5>Comments ({{ post.comments.count }})</h5>
  {% for comment in post.comments.all %}
    <p><strong>{{ comment.user.username }}</strong>: {{ comment.body }}</p>
  {% empty %}
    <p class="text-muted">No comments yet.</p>
  {% endfor %}

  <!-- Comment qo‘shish -->
  <form method="post" class="mt-3">
    {% csrf_token %}
    {{ comment_form.as_p }}
    <button type="submit" class="btn btn-sm btn-success">Add Comment</button>
  </form>
</div>
{% endblock %}
